{% extends "base.html" %}
{% load humanize %}
{% block contents %}
<div class="row mt-5">
    <div class="col-12">
        <div class="card" style="width: 100%;">
            <div class="card-body">
                <h5 class="card-title">{{ tal_detail.name }}</h5>
                <!-- í˜„ì¬ ì „ì²´ ì¢‹ì•„ìš” í•© -->
                <div>â¤ï¸ {{tal_detail.like}}</div>
                <!-- í´ë¦½ë³´ë“œ ì£¼ì†Œ ë³µì‚¬ -->
                <button type="button" class="btn btn-success" id="copyButton" value="{{page_path}}">ğŸ“‹</button>
            </div>
            
            <li class="list-group-item">
                <!-- ì¦ê²¨ì°¾ê¸°ìš© ë¶€ë¶„ -->
                <form action="/favorite/create" method="POST">
                    {% csrf_token %}                    
                    {% for field in form %}
                    <div class="form-group">
                        <input type="{{ field.field.widget.input_type }}" class="form-control" 
                        id="{{ field.id_for_label }}"  placeholder="{{ field.label }}" name="{{ field.name }}" 
                        value="{% if field.name == 'like' %}{{ '1' }}{% else %}{{tal_detail.id}}{% endif %}"/> 
                    </div>                       
                        {% if field.errors %}
                        <span style="color: red">{{ field.errors }}</span>
                        {% endif %}
                    
                    {% endfor %}                    
                    {% if search.like == 1 %}
                    <button type="submit" class="btn btn-warning">ğŸ’”</button>
                    {% else %}
                    <button type="submit" class="btn btn-primary">â¤ï¸</button>
                    {% endif %}
                </form>
                <!-- ì¦ê²¨ì°¾ê¸°ìš© ë¶€ë¶„ ë-->
            </li>
            <!-- ìƒì„¸ì„¤ëª… ë¶€ë¶„ -->
            <ul class="list-group list-group-flush">
                <li class="list-group-item">ì œì¡°ì‚¬: {{ tal_detail.company }}</li>
                <li class="list-group-item">ì›ì¬ë£Œ: {{ tal_detail.mtrl }}</li>
                <li class="list-group-item">ìš©ëŸ‰/ë„ìˆ˜: {{ tal_detail.std }}</li>
                <li class="list-group-item">ìƒì„¸ì„¤ëª…: {{ tal_detail.dsc }}</li>        
                <li class="list-group-item"><img src="{{tal_detail.img}}" alt=""></li>                       
            </ul>
            <!-- ìƒì„¸ì„¤ëª… í‰ê· ê·¸ë˜í”„ ë¶€ë¶„ -->
            {{ graph_html | safe }}

        </div>
    </div>
</div>
<hr/>
<!-- ëŒ“ê¸€ ì „ì²´ ë‚´ìš© -->
<div class="row mt-5">
    <div class="col-12">
        <div class="comment">
        <h5>&#35; ëŒ“ê¸€</h5><br/>
        {% for comment, graph_comments in comments_and_graphs %}        
            
            <p class="comment-name">{{comment.name}} : {{comment.body}} </p>
            <p class="comment-score-group">ìƒ‰ : {{comment.color}} </p>
            <p class="comment-score-group">í–¥ : {{comment.flavor}} </p>
            <p class="comment-score-group">ë‹¹ë„ : {{comment.sweet}} </p>
            <p class="comment-score-group">ì‚°ë„ : {{comment.sour}} </p>
            <p class="comment-score-group">íƒ„ì‚°ê° : {{comment.carbon}} </p>
            <p class="comment-score-group">ì¢…í•©í‰ê°€ : {{comment.total}} </p>
            <!-- ì½”ë©˜íŠ¸ë³„ ê·¸ë˜í”„ / ë°˜ë“œì‹œ forë¬¸ ì•ˆì— ìˆì–´ì•¼ í•¨-->
            {{ graph_comments | safe }}
            <!-- ì½”ë©˜íŠ¸ë³„ ê·¸ë˜í”„ ë -->
            {% if email == comment.name.email %}
            <button type="button" class="btn btn-danger" onclick="location.href='/comment/delete/{{comment.id}}/'">ì‚­ì œí•˜ê¸°</button>
            <button type="button" class="btn btn-success" onclick="location.href='/comment/update/{{comment.id}}/'">ìˆ˜ì •í•˜ê¸°</button>            
            {% endif %}
            
            <hr/>
        {% empty %}
            <p>ì•„ì§ ë“±ë¡ëœ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endfor %}
            
        </div>        
    </div>
</div>
<hr/>
<!-- ëŒ“ê¸€ ì‘ì„± í¼ -->
<div class="row mt-5">
    <div class="col-12">
        <h3>Add a Comment</h3>
        <form method="POST">
            {% csrf_token %}
            {{comment_form.as_p}}
            <!-- models.py ë°ì´í„°ë² ì´ìŠ¤(comment)ì˜ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¡œ, forms.pyë¥¼ ê±°ì³ nameê³¼ bodyí•„ë“œë¥¼ píƒœê·¸ë¡œ ê°ì‹¸ì„œ ì¶œë ¥  -->
            <button type="submit" class="btn btn-primary">ëŒ“ê¸€ì‘ì„±</button>
        </form>
    </div>
</div>

<script>
    document.getElementById("copyButton").addEventListener("click", function() {
        // Get the value from the button's 'value' attribute
        var pagePath = this.value;

        // Create a temporary input element to hold the text
        var tempInput = document.createElement("input");
        tempInput.value = pagePath;

        // Append the input element to the body
        document.body.appendChild(tempInput);

        // Select the text inside the input element
        tempInput.select();

        // Copy the selected text to the clipboard
        document.execCommand("copy");

        // Remove the temporary input element
        document.body.removeChild(tempInput);

        // Optionally, provide feedback to the user
        alert("í˜„ì¬ í˜ì´ì§€ì˜ ì£¼ì†Œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n" + "ì£¼ì†Œ: "+ pagePath);
    });
</script>
{% endblock %}