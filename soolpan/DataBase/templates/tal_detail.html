{% extends "base1.html" %}
{% load static %}
{% load humanize %}

{% block header %}
<link rel="stylesheet" type="text/css" href="{% static 'css/detail_new.css' %}">
{% endblock %} 

{% block contents %}
<div class="row mt-5">
  <div class="col-12">
    <div class="card" style="width: 100%;">

      <div class="card-body">
        <h5 class="card-title" style="text-align: center;">{{ tal_detail.name }}
        <!-- í˜„ì¬ ì „ì²´ ì¢‹ì•„ìš” í•© -->
          <div class="float-right">â¤ï¸ {{tal_detail.like}}</div>
        </h5>
      </div>

      <!-- ì¦ê²¨ì°¾ê¸°ìš© ë¶€ë¶„ -->
      <form action="/favorite/create" method="POST">
      {% csrf_token %}                    
      {% for field in form %}
        <div class="form-group">
          <input type="{{ field.field.widget.input_type }}" class="form-control" 
          id="{{ field.id_for_label }}"  placeholder="{{ field.label }}" name="{{ field.name }}" 
          value="{% if field.name == 'like' %}{{ '1' }}{% else %}{{tal_detail.id}}{% endif %}"/> 
        </div>                       
        {% if field.errors %}
        <span style="color: red">{{ field.errors }}</span>
        {% endif %}
        {% endfor %}
        <div class="float-right">
          {% if search.like == 1 %}
          <button type="submit" class="btn btn-warning">ğŸ’”</button>
          {% else %}
          <button type="submit" class="btn btn-primary">â¤ï¸</button>
          {% endif %}
          <!-- í´ë¦½ë³´ë“œ ì£¼ì†Œ ë³µì‚¬ -->
          <button type="button" class="btn btn-success" id="copyButton" value="{{page_path}}">ğŸ“‹ </button>
        </div>
      </form>
      <!-- ì¦ê²¨ì°¾ê¸°ìš© ë¶€ë¶„ ë-->

      <!-- ìƒì„¸ì„¤ëª… ë¶€ë¶„ -->
      <ul class="list-group list-group-flush">
        <li class="list-group-item">ì œì¡°ì‚¬: {{ tal_detail.company }}</li>
        <li class="list-group-item">ì›ì¬ë£Œ: {{ tal_detail.mtrl }}</li>
        <li class="list-group-item">ìš©ëŸ‰/ë„ìˆ˜: {{ tal_detail.std }}</li>
        <li class="list-group-item">ìƒì„¸ì„¤ëª…: {{ tal_detail.dsc }}</li>        
      </ul>
      <form action="" style="display: flex; justify-content: space-between;">
        <div class="left-side" style="width: 50%;">
          <img src="{{tal_detail.img}}" alt="">
        </div>
        <!-- ìƒì„¸ì„¤ëª… í‰ê· ê·¸ë˜í”„ ë¶€ë¶„ -->
        <div class="right-side" style="width: 60%;">
          <br>
          {{ graph_html | safe }}
        </div>
      </form>
    </div>
  </div>
</div>

<!-- ëŒ“ê¸€ ì „ì²´ ë‚´ìš© -->
<div class="row mt-5">
  <div class="col-12">
    <div class="comment">
      <h5>&#35; ëŒ“ê¸€</h5>
      <br/>
      <!-- ì§ë ¬ë¡œ forë¬¸ ëŒë¦¼(í˜ì´ì§€ë„¤ì´í„° ì‘ë™í•˜ê³  ë†’ì´ ì¡°ì ˆ ì´ìŠˆ ìˆìŒ.) -->

      <div class="table-container" style="display: flex; justify-content: space-between;">
        <div class="left-side" style="width: 50%;">
          <h5>ê·¸ë˜í”„</h5>
          <table>
            {% for comment in comments_graph %}
            <tr>    
                <td style="height: 350px;">{{ comment | safe }}</td>    
            </tr>
            {% endfor %}
          </table>
        </div>

        <div class="right-side" style="width: 50%;">
          <h5>ì½”ë©˜íŠ¸</h5>
          <table>
            {% for comment in comments_write %}
            <tr>
              <td style="height: 350px;">
                {{ comment.name }}
                <br>
                <br>
                {{ comment.body }}
              </td>
            </tr>
            {% endfor %}
          </table>
        </div>
      </div>

    </div>        
  </div>
</div>
<hr/>
<div>
<!-- Pagination -->
{% if comments_write.has_other_pages %}
  <nav aria-label="Comment navigation">
    <ul class="pagination justify-content-center">
      {% if comments_write.has_previous %}
        <li class="page-item">
          <a class="page-link" href="?page=1" aria-label="First">
            <span aria-hidden="true">&laquo;&laquo;</span>
          </a>
        </li>
        <li class="page-item">
          <a class="page-link" href="?page={{ comments_write.previous_page_number }}" aria-label="Previous">
            <span aria-hidden="true">&laquo;</span>
          </a>
        </li>
      {% endif %}

      {% for page in comments_write.paginator.page_range %}
        <li class="page-item {% if page == comments_write.number %}active{% endif %}">
          <a class="page-link" href="?page={{ page }}">{{ page }}</a>
        </li>
      {% endfor %}

      {% if comments_write.has_next %}
        <li class="page-item">
          <a class="page-link" href="?page={{ comments_write.next_page_number }}" aria-label="Next">
            <span aria-hidden="true">&raquo;</span>
          </a>
        </li>
        <li class="page-item">
          <a class="page-link" href="?page={{ comments_write.paginator.num_pages }}" aria-label="Last">
            <span aria-hidden="true">&raquo;&raquo;</span>
          </a>
        </li>
      {% endif %}
    </ul>
  </nav>
{% endif %}
</div>
<!-- ëŒ“ê¸€ ì‘ì„± í¼ -->
<div class="row mt-5">
  <div class="col-12">
    <h3>ëŒ“ê¸€ ì‘ì„±</h3>
      <form method="POST">
        {% csrf_token %}
        <div class="table-container" style="display: flex; justify-content: space-between;">
          <div class="left-side" style="width:50%;">
            <br>
            <p>{{ comment_form.body }}</p>
          </div>
          <div class="right-side" style="width:60%;">
            <table>
              <tr>
                <td>ìƒ‰</td>
                <td>{{ comment_form.color }}</td>
              </tr>
              <tr>
                <td>íƒ„ì‚°ê°</td>
                <td>{{ comment_form.carbon }}</td>
              </tr>
              <tr>
                <td>í–¥</td>
                <td>{{ comment_form.flavor }}</td>
              </tr>
              <tr>
                <td>ì‚°ë¯¸</td>
                <td>{{ comment_form.sour }}</td>
              </tr>
              <tr>
                <td>ë‹¹ë„</td>
                <td>{{ comment_form.sweet }}</td>
              </tr>
              <tr>
                <td>ì¢…í•©í‰ê°€</td>
                <td>{{ comment_form.total }}</td>
              </tr>
            </table>
            <div class="float-right">
              <button type="submit" class="btn btn-primary">ëŒ“ê¸€ì‘ì„±</button>
            </div>
          </div>
        </div>
      </form>
    </div>
</div>
<div style="margin-top: 70px;"></div>

<script>
  document.getElementById("copyButton").addEventListener("click", function() {
      // Get the value from the button's 'value' attribute
      var pagePath = this.value;

      // Create a temporary input element to hold the text
      var tempInput = document.createElement("input");
      tempInput.value = pagePath;

      // Append the input element to the body
      document.body.appendChild(tempInput);

      // Select the text inside the input element
      tempInput.select();

      // Copy the selected text to the clipboard
      document.execCommand("copy");

      // Remove the temporary input element
      document.body.removeChild(tempInput);

      // Optionally, provide feedback to the user
      alert("í˜„ì¬ í˜ì´ì§€ì˜ ì£¼ì†Œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n" + "ì£¼ì†Œ: "+ pagePath);
  });
</script>
{% endblock %} 